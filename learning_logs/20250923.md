# ì…ì‹¤ ì²´í¬ í•´ì£¼ì„¸ìš” !! ğŸ’Œ
1. visual studio codeë¡œ .md íŒŒì¼
2. intellijë¡œ ì½”ë“œ ì‘ì„±ìœ¼ë¡œ í•˜ê² ìŠµë‹ˆë‹¤.

# SpringBoot Project ìƒì„±
https://start.spring.io
Gradle - Groovy
Java
3.5.6
Artifact com.example.cardatabase
Jar
17

ê·¸ë¦¬ê³  Add Dependencies click
Spring Web
Spring Boot Dev tools
Lombok
Spring Data JPA

SpringBootì˜ ê°„ë‹¨ ì„¤ëª…
Entityì˜ ê°œë…
JPAê°€ ê·¸ë˜ì„œ Entityì™€ ì–´ë–»ê²Œ ì—°ê²°ë˜ì–´ìˆê³ , inmemory databaseì¸ h2ì™€ ì–´ë–»ê²Œ ì—°ê²°ì´ ë˜ëŠ”ì§€ ì—¬ë¶€ë„ ìˆ˜ì—….
build.gradle / application.propertiesë¼ê³  í•˜ëŠ” íŒŒì¼ë“¤ì— ëª…ë ¹ì–´ë“¤ì„ ì‘ì„±í•˜ê²Œ ëìŠµë‹ˆë‹¤.

Entity í´ë˜ìŠ¤ì˜ ê²½ìš°ì—ëŠ” DBì—ì„œì˜ table ì—­í• ì„ í•¨.
Entity í´ë˜ìŠ¤ì˜ fieldë“¤ì€ column ì—­í• ì„ í•¨.
JPAì™€ ì—°ë™ ë˜ì–´ìˆê¸° ë•Œë¬¸ì— í•„ìˆ˜ì ìœ¼ë¡œ ê¸°ë³¸ ìƒì„±ìë¥¼ ìš”êµ¬í•¨.
idê°’ì„ AUTOë¡œ ì¡ì•„ë†¨ê¸° ë•Œë¬¸ì—(ì¦‰, ìƒì„±ë  ë•Œë§ˆë‹¤ dbì—ì„œ ê³ ìœ  idê°’ì„ ë¶€ì—¬í•˜ê¸° ë•Œë¬¸ì—)
@AllArgsConstructorë¥¼ ì ìš©í•˜ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.


Lombokì´ ì ìš©ë˜ì§€ ì•Šì•˜ì„ ë•Œì˜ ê¸°ë³¸ì ì¸ Entity classì˜ êµ¬ì¡°
```java
package com.example.cardatabase.domain;

import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;
import lombok.NoArgsConstructor;

@Entity
public class Owner {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long ownerId;
    
    private String firstName, lastName;
    
    // Lombok ì‚¬ìš©í•˜ì§€ ì•Šê³ , ê¸°ë³¸ ìƒì„±ì ë° ownerIdë¥¼ ì œì™¸í•œ RequiredArgsConstructorë¥¼ ìƒì„±í•  ê²ƒ
    // Lombok ì‚¬ìš©í•˜ì§€ ì•Šê³ , ê° fieldì— ëŒ€í•œ getter setterë¥¼ ìƒì„±í•  ê²ƒ

    public Owner() {}

    public Owner(String firstName, String lastName) {
        this.firstName = firstName;
        this.lastName = lastName;
    }

    public Long getOwnerId() {
        return ownerId;
    }

    public void setOwnerId(Long ownerId) {
        this.ownerId = ownerId;
    }

    public String getFirstName() {
        return firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

    public String getLastName() {
        return lastName;
    }

    public void setLastName(String lastName) {
        this.lastName = lastName;
    }
}
```

Lombokì´ ì ìš©ëœ Entity Classì˜ êµ¬ì¡°

```java
package com.example.cardatabase.domain;

import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;
import lombok.*;

@Entity
@Getter
@Setter
@ToString
@NoArgsConstructor(force = true)
@RequiredArgsConstructor
public class Owner {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long ownerId;

    private final String firstName;
    private final String lastName;
}
```
- `@NoArgsConstructor(force = true)` : final í•„ë“œê°€ ìˆëŠ” ê²½ìš°ì—ë„ í•´ë‹¹ í•„ë“œë¥¼ nullë¡œ ì´ˆê¸°í™”í•˜ëŠ” ìƒì„±ìë¥¼ ê°•ì œë¡œ ìƒì„±í•´ì£¼ê¸° ë•Œë¬¸ì— `final` í‚¤ì›Œë“œê°€ ë¶™ì€ ê²½ìš°ì—ë„ JPAì—ì„œ ìš”êµ¬ë˜ëŠ” ê¸°ë³¸ ìƒì„±ìë¥¼ ë§Œë“¤ ìˆ˜ ìˆê³ , `@RequiredArgsConstructor`ì™€ë„ ì¶©ëŒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

http://localhost:8080/h2-console
ë“¤ì–´ê°€ì„œ ì¢Œì¸¡ í™•ì¸í•´ë³´ì‹œë©´ OWNER tableì´ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## í…Œì´ë¸” ê°„ì˜ ê´€ê³„ ì¶”ê°€
car í…Œì´ë¸”ê³¼ ì¼ëŒ€ë‹¤(1:N) ê´€ê³„ì— ìˆëŠ” ownerë¼ëŠ” ìƒˆ í…Œì´ë¸”ì„ ë§Œë“¤ê²ë‹ˆë‹¤. ì¼ëŒ€ë‹¤ ê´€ê³„ëŠ” ì†Œìœ ìê°€ í•œ ëª…ì´ ìë™ì°¨ ì—¬ëŸ¬ ëŒ€ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆì§€ë§Œ, í•œ ìë™ì°¨ì˜ ì†Œìœ ìëŠ” í•œ ëª…ì´ë¼ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.

domain íŒ¨í‚¤ì§€ì— Ownerì´ë¼ëŠ” ì—”í‹°í‹° í´ë˜ìŠ¤ì™€ OwnerRepositoryë¼ëŠ” repository ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  OwnerRepositoryëŠ” JpaReposiotryë¥¼ ìƒì† ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.

ì´ìƒì˜ ì¼ëŒ€ë‹¤ ê´€ê³„ë¥¼ ì¶”ê°€í•˜ë ¤ë©´ `@ManyToOne`ê³¼ `@OneToMany` ì• ë„ˆí…Œì´ì…˜(jakarta.persistence)ì„ ì´ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ì™¸ë˜ í‚¤ë¥¼ í¬í•¨í•œ Car ì—”í‹°í‹° í´ë˜ìŠ¤ì—ì„œëŠ” `@ManyToOne`ì„ ì‚¬ìš©í• ê²ë‹ˆë‹¤(ì´ê²ƒ ë•Œë¬¸ì— ìœ„ì— ë¶€ë¶„ ë³µì‚¬í•´ì™”ìŠµë‹ˆë‹¤). ê·¸ë¦¬ê³  ì™¸ë˜í‚¤ë¥¼ ì¶”ê°€í–ˆê¸° ë•Œë¬¸ì— field êµ¬ì„±ì´ ë‹¬ë¼ì ¸ì•¼ê² ì£ .

ê·¸ëŸ¼ DB ì ìœ¼ë¡œ ë´¤ì„ ë•ŒëŠ” car tableì—ë‹¤ê°€ ì™¸ë˜í‚¤ì¸ ownerIdë¥¼ ì¶”ê°€í•˜ëŠ” ê°œë…ì´ë¼ê³  ë³¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— Car entity classì—ëŠ” Owner ê´€ë ¨ fieldë¥¼ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ìƒˆë¡œ ì¶”ê°€ëœ fieldì— ëŒ€í•œ getter / setterë„ ìš”êµ¬ë ê²ë‹ˆë‹¤. ëª¨ë“  JOIN ê´€ê³„ì—ì„œëŠ” FetchType.LAZYë¥¼ ì´ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ëŒ€ë‹¤(toMany) ê´€ê³„ì˜ ê²½ìš°ì—ëŠ” FetchType.LAZYê°€ ê¸°ë³¸ê°’ì´ë¯€ë¡œ ì •ì˜í•  í•„ìš”ê°€ ì—†ì§€ë§Œ ëŒ€ì¼(toOne) ê´€ê³„ì˜ ê²½ìš°ì—ëŠ” ë°˜ë“œì‹œ ëª…ì‹œí•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.

FetchType : DBì—ì„œ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ëŠ” ì „ëµì„ ì •ì˜. ì†ì„±ê°’ìœ¼ë¡œëŠ”
  EAGER : ì¦‰ì‹œ ê²€ìƒ‰
  LAZY : ì§€ì—° ê²€ìƒ‰
ì €í¬ ì˜ˆì œì—ì„œëŠ” ì§€ì—° ê²€ìƒ‰(LAZY)ì€ DBì—ì„œ ì†Œìœ ìë¥¼ ê²€ìƒ‰í•˜ë©´ í•„ìš”í•  ë•Œ í•´ë‹¹ ì†Œìœ ìì™€ ì—°ê´€ëœ ëª¨ë“  ìë™ì°¨ë¥¼ ê²€ìƒ‰í•œë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤. ë°˜ë©´ ì¦‰ì‹œ ê²€ìƒ‰(EAGER)ì€ í•´ë‹¹ ì†Œìœ ìì˜ ëª¨ë“  ìë™ì°¨ë¥¼ ì¦‰ì‹œ ê²€ìƒ‰í•©ë‹ˆë‹¤.

```java
// Car.java
{
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;
    private String brand, model, color, registrationNumber;
    private int modelYear, price;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "owner")
    private Owner owner;

    public Owner getOwner() {
        return owner;
    }

    public void setOwner(Owner owner) {
        this.owner = owner;
    }

    public Car(String brand, String model, String color, String registrationNumber, int modelYear, int price) {
        this.brand = brand;
        this.model = model;
        this.color = color;
        this.registrationNumber = registrationNumber;
        this.modelYear = modelYear;
        this.price = price;
    }
}
// Owner.java
package com.example.cardatabase.domain;

import jakarta.persistence.*;
import lombok.*;

import java.util.List;

@Entity
@Getter
@Setter
@ToString
@NoArgsConstructor(force = true)
@RequiredArgsConstructor
public class Owner {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long ownerId;

    @NonNull
    private String firstName;
    @NonNull
    private String lastName;

    // ì†Œìœ ìëŠ” ë‹¤ìˆ˜ì˜ ì°¨ë“¤ì„ ê°€ì§ˆ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— Collectionsë¥¼ ì‚¬ìš©.
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "owner")
    private List<Car> cars;
}
```
ì´ìƒì˜ ì½”ë“œì—ì„œ `@Data`ë¥¼ ë‹¬ì•„ë‘” ê²½ìš°ì— ì¼ë¶€ëŸ¬ ê²¹ì¹˜ì§€ë§Œ Ownerì™€ ê´€ë ¨ëœ getter / setterë¥¼ ì½”ë“œë¡œ ì¨ë‘ì—ˆìŠµë‹ˆë‹¤. ë°˜ë©´ì— `@Getter, @Setter`ë¥¼ ëª…ì‹œí•´ë‘” Owner í´ë˜ìŠ¤ì—ëŠ” cars ê´€ë ¨ getter/ setterë¥¼ ì•ˆ ì¼ìŠµë‹ˆë‹¤. ë‹¹ì—°íˆ í”„ë¡œì íŠ¸ í•˜ì‹¤ ë•ŒëŠ” setOwner() / getOwner()ë¥¼ ì½”ë“œë¡œ ì“°ì‹¤ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.

Owner classì˜ `@OneToMany` ì• ë„ˆí…Œì´ì…˜ì—ëŠ” íŠ¹ì„±ì´ ìˆìŠµë‹ˆë‹¤.
1. cascade ì†ì„±ì€ ì‚­ì œ / ì—…ë°ì´íŠ¸ ì‹œ ì—°ì† íš¨ê³¼ê°€ ì ìš©ë˜ëŠ” ë°©ë²•ì„ ì§€ì •í•©ë‹ˆë‹¤. 
  - ALLë¡œ ì„¤ì •í•˜ê²Œ ë˜ë©´ ëª¨ë“  ì‘ì—…ì´ ì—°ì†ì ìœ¼ë¡œ ì ìš©ë©ë‹ˆë‹¤.
  - ì˜ˆë¥¼ ë“¤ì–´ Ownerë¥¼ ì‚­ì œí•˜ê²Œ ë˜ë©´ ê·¸ ì†Œìœ ìì™€ ì—°ê²°ëœ Car ê°ì²´ë“¤ë„ ì „ë¶€ ë‹¤ ì‚­ì œë©ë‹ˆë‹¤.
2. mappedBy="owner" ì†ì„± ì„¤ì • : Car í´ë˜ìŠ¤ ì‚¬ì´ì— ì´ ê´€ê³„ì˜ ì™¸ë˜ í‚¤ì¸ owner í•„ë“œê°€ ì¡´ì¬í•¨ì„ ëª…ì‹œí•¨.

SQLì„ ë°°ìš´ ì €í¬ê°€ ì¢€ ì–´ìƒ‰í•˜ê²Œ ëŠê»´ì§ˆ ìˆ˜ ìˆëŠ” ê²ƒì€ ownerId í•„ë“œ í•˜ë‚˜ë§Œ ê°€ì§€ê³  ì™€ì„œ ì—°ê²°ì§“ëŠ”ê²Œ ì•„ë‹ˆë¼ Owner í´ë˜ìŠ¤ë¥¼ í†µì§¸ë¡œ ë“¤ê³ ì™€ì„œ Carì— fieldë¡œ ì‚¼ëŠ”ë‹¤ëŠ” ì ì…ë‹ˆë‹¤.

## H2 -> MariaDBë¡œ ì´ì‹
h2 versionì„ pushí•©ë‹ˆë‹¤.

git add .
git commit -m "feat: h2 ì¸ë©”ëª¨ë¦¬ ì„¤ì • ê´€ë ¨ ì½”ë“œ"
git push